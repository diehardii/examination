试卷实体：
package seucxxy.csd.backend.entity;



import java.util.List;

public class ExamPaper {
    private Long id;
    private String examPaperName;
    private String examPaperContent;
    private String examPaperDifficulty;
    private int examPaperQuestionNumber;
    private String examPaperSubject;
    private List<Question> questions;

    // Getters and Setters
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getExamPaperName() {
        return examPaperName;
    }

    public void setExamPaperName(String examPaperName) {
        this.examPaperName = examPaperName;
    }

    public String getExamPaperContent() {
        return examPaperContent;
    }

    public void setExamPaperContent(String examPaperContent) {
        this.examPaperContent = examPaperContent;
    }

    public String getExamPaperDifficulty() {
        return examPaperDifficulty;
    }

    public void setExamPaperDifficulty(String examPaperDifficulty) {
        this.examPaperDifficulty = examPaperDifficulty;
    }

    public int getExamPaperQuestionNumber() {
        return examPaperQuestionNumber;
    }

    public void setExamPaperQuestionNumber(int examPaperQuestionNumber) {
        this.examPaperQuestionNumber = examPaperQuestionNumber;
    }

    public String getExamPaperSubject() {
        return examPaperSubject;
    }

    public void setExamPaperSubject(String examPaperSubject) {
        this.examPaperSubject = examPaperSubject;
    }

    public List<Question> getQuestions() {
        return questions;
    }

    public void setQuestions(List<Question> questions) {
        this.questions = questions;
    }
}
用户实体
package seucxxy.csd.backend.entity;

import lombok.Data;

@Data
public class User {
    private Long  id;
    private String username;
    private String phone;
    private String password;
    private Integer roleId;


    private Role role;
    // 必须显式添加getRole()方法（即使使用@Data注解）
    public Role getRole() {
        if (this.role == null) {
            this.role = new Role(); // 防止NPE
        }
        return this.role;
    }
    // 显式setter确保数据同步
    public void setRole(Role role) {
        this.role = role;
        if (role != null) {
            this.roleId = role.getRoleId();
        }
    }
}

用户试卷关系实体
package seucxxy.csd.backend.entity;


public class UserExamPaper {
    private Long id;
    private Long examPaperId;
    private String username;

    // Getters and Setters
    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public Long getExamPaperId() {
        return examPaperId;
    }

    public void setExamPaperId(Long examPaperId) {
        this.examPaperId = examPaperId;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }
}
package seucxxy.csd.backend.controller;




import jakarta.servlet.http.HttpSession;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;
import seucxxy.csd.backend.entity.User;
import seucxxy.csd.backend.service.ExamPaperService;
import seucxxy.csd.backend.service.UserExamPaperService;

import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

@Controller
@RequestMapping("/exam-paper")
public class PaperManController {
    private final ExamPaperService examPaperService;
    private final UserExamPaperService userExamPaperService;

    @Autowired
    public PaperManController(ExamPaperService examPaperService, UserExamPaperService userExamPaperService) {
        this.examPaperService = examPaperService;
        this.userExamPaperService = userExamPaperService;
    }

    @GetMapping("/paper-man")
    public String managePapers(Model model, HttpSession session) {
        User user = (User) session.getAttribute("user");
        String username = user.getUsername();
        model.addAttribute("availablePapers", examPaperService.getAvailableExamPapers(username));
        model.addAttribute("userPapers", userExamPaperService.getUserExamPapers(username));
        model.addAttribute("user", user);
        return "/exam-paper/paper-man";
    }

    @PostMapping("/paper-save")
    public String saveUserPapers(@RequestParam("examPaperIds") String examPaperIds,HttpSession session) {
        User user = (User) session.getAttribute("user");
        String username = user.getUsername();


        List<Long> ids = Arrays.stream(examPaperIds.split(","))
                .filter(id -> !id.isEmpty())
                .map(Long::parseLong)
                .collect(Collectors.toList());

        userExamPaperService.saveUserExamPapers(username, ids);
        return "redirect:/exam-paper/paper-man";
    }
}

试卷选择控制器，功能为从所有试卷中选择部分试卷作为用户的试卷，并保存关系
package seucxxy.csd.backend.service;

import org.springframework.security.core.Authentication;
import org.springframework.security.core.context.SecurityContextHolder;
import seucxxy.csd.backend.entity.*;
import seucxxy.csd.backend.mapper.*;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.*;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.client.RestTemplate;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

@Service
public class UserExamPaperService {
    private final ExamPaperMapper examPaperMapper;
    private final UserExamPaperMapper userExamPaperMapper;
    private final RestTemplate restTemplate;



    public UserExamPaperService(ExamPaperMapper examPaperMapper,
                            UserExamPaperMapper userExamPaperMapper,
                            RestTemplate restTemplate) {
        this.examPaperMapper = examPaperMapper;
        this.userExamPaperMapper = userExamPaperMapper;
        this.restTemplate = restTemplate;
    }


    public List<ExamPaper> getUserExamPapers(String username) {
        return userExamPaperMapper.findExamPapersByUsername(username);
    }
    public void saveUserExamPapers(String username, List<Long> examPaperIds) {
        // 先删除用户原有的试卷关系
        userExamPaperMapper.deleteByUsername(username);

        // 添加新的试卷关系
        examPaperIds.forEach(examPaperId -> {
            UserExamPaper userExamPaper = new UserExamPaper();
            userExamPaper.setExamPaperId(examPaperId);
            userExamPaper.setUsername(username);
            userExamPaperMapper.insert(userExamPaper);
        });
    }

}
上面是用户试卷关系的服务
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>试卷管理</title>
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <link rel="stylesheet" th:href="@{/css/menuStyle.css}">
    <style>
        /* 保持原有的CSS样式不变 */
        .paper-container {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 20px;
            padding-left: 10px;
        }

        .paper-list {
            width: 100%;
            height: 400px;
            overflow: auto;
            border: 1px solid #ddd;
            background-color: #f0f8ff;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            white-space: nowrap;
            box-sizing: border-box;
        }

        /* 其他样式保持不变... */
        /* 表格容器样式 */
        .paper-container {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 20px;

            padding-left: 10px; /* 可选：左侧内边距 */

        }

        .paper-list {
            width: 100%; /* 适应父容器宽度 */
            height: 400px; /* 减去标题高度，避免重叠 */

            overflow: auto;
            border: 1px solid #ddd;
            background-color: #f0f8ff; /* 淡蓝色背景 */
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            white-space: nowrap;
            box-sizing: border-box; /* 关键：包含内边距和边框 */
        }
        .paper-section {
            position: relative; /* 为标题提供定位上下文 */
            width: 45%; /* 与原容器宽度一致 */
            box-sizing: border-box; /* 关键：统一盒模型计算 */
        }

        .sticky-title {
            position: sticky; /* 粘性定位，随滚动固定在视口顶部 */
            top: 0; /* 距离顶部0像素 */
            left: 0; /* 左侧对齐 */
            margin: 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            color: #003366;
            z-index: 20; /* 确保标题在表格上方 */
            white-space: nowrap; /* 防止标题文字换行 */
            box-sizing: border-box; /* 包含内边距和边框 */
            width: 100%; /* 撑满父容器宽度 */


        }
        /* 表格样式 */
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            table-layout: auto; /* 关键：自动布局，单元格宽度随内容调整 */
        }

        /* 表头样式 - 不可选中/不可交互 */
        /* 表头样式 */
        thead tr {
            position: sticky;
            top: 0;
            z-index: 10;
            background-color: #f3e5ff !important;
            background-image: linear-gradient(to bottom, #f3e5ff, #e6d1f9);
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        thead th {
            padding: 12px 15px;
            text-align: left;
            background-color: #f8f9fa;
            color: #003366;
            font-weight: 600;
            border-bottom: 2px solid #d8bfd8; /* 浅紫色边框 */
            white-space: nowrap;
        }

        /* 内容行样式 - 可交互 */
        tbody tr {
            cursor: pointer;
            transition: background-color 0.2s;
        }

        tbody tr td {
            padding: 12px 15px;
            border-bottom: 1px solid #dee2e6;
            color:#333;
        }

        /* 高亮样式 */
        tbody tr.highlight {
            background-color: #e6f7ff !important;
            color: #003366 !important;
        }

        tbody tr:hover:not(.highlight) {
            background-color: #f8f9fa;
        }

        /* 按钮容器样式 */
        .button-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 10%;
        }

        .transfer-btn {
            margin: 10px 0;
            padding: 8px 12px;
            font-size: 16px;
            cursor: pointer;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .transfer-btn:hover {
            background-color: #e9ecef;
            border-color: #adb5bd;
        }
        /* 新增按钮容器样式 */
        .submit-btn-container {
            display: flex;
            justify-content: center;
            width: 100%;
            margin-top: 20px;
        }

        /* 提交按钮样式 */
        .submit-btn {
            margin-top: 20px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.2s;
        }

        .submit-btn:hover {
            background-color: #45a049;
        }

        /* 滚动条样式 */
        .paper-list::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .paper-list::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .paper-list::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .paper-list::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* ... */
    </style>
</head>
<body>
<div th:replace="~{fragments/menu :: menu}"></div>

<div class="content">
    <h2 class="header">试卷管理</h2>

    <div class="paper-container">
        <div class="paper-section">
            <h3 class="sticky-title">可选试卷</h3>
            <div class="paper-list fixed-height">
                <table id="allPapersTable">
                    <thead>
                    <tr>
                        <th>试卷ID</th>
                        <th>试卷名称</th>
                        <th>试卷内容</th>
                        <th>难度</th>
                        <th>题目数量</th>
                        <th>试卷科目</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="paper : ${availablePapers}"
                        onclick="highlightRow(this, 'allPapersTable')">
                        <td th:text="${paper.id}"></td>
                        <td th:text="${paper.examPaperName}"></td>
                        <td th:text="${paper.examPaperContent}"></td>
                        <td th:text="${paper.examPaperDifficulty}"></td>
                        <td th:text="${paper.examPaperQuestionNumber}"></td>
                        <td th:text="${paper.examPaperSubject}"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="button-container">
            <button class="transfer-btn" onclick="transferRight()">→</button>
            <button class="transfer-btn" onclick="transferLeft()">←</button>
        </div>

        <div class="paper-section">
            <h3 class="sticky-title">我的试卷</h3>
            <div class="paper-list fixed-height">
                <table id="userPapersTable">
                    <thead>
                    <tr>
                        <th>试卷ID</th>
                        <th>试卷名称</th>
                        <th>试卷内容</th>
                        <th>难度</th>
                        <th>题目数量</th>
                        <th>试卷科目</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="paper : ${userPapers}"
                        onclick="highlightRow(this, 'userPapersTable')">
                        <td th:text="${paper.id}"></td>
                        <td th:text="${paper.examPaperName}"></td>
                        <td th:text="${paper.examPaperContent}"></td>
                        <td th:text="${paper.examPaperDifficulty}"></td>
                        <td th:text="${paper.examPaperQuestionNumber}"></td>
                        <td th:text="${paper.examPaperSubject}"></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="submit-btn-container">
        <button class="submit-btn" onclick="submitUserPapers()">确认保存</button>
    </div>
    <form id="hiddenForm" th:action="@{/exam-paper/paper-save}" method="post" style="display:none;">
        <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
        <input type="hidden" name="examPaperIds" id="examPaperIdsInput"/>
    </form>
</div>

<script th:inline="javascript">
    /* 保持原有的JavaScript函数不变 */
    function highlightRow(row, tableId) {
        var tbody = document.getElementById(tableId).getElementsByTagName('tbody')[0];
        var rows = tbody.getElementsByTagName('tr');
        for (var i = 0; i < rows.length; i++) {
            rows[i].classList.remove('highlight');
        }
        row.classList.add('highlight');
    }

    function transferRight() {
        var leftTable = document.getElementById('allPapersTable');
        var leftTbody = leftTable.getElementsByTagName('tbody')[0];
        var highlightedRow = leftTbody.querySelector('tr.highlight');

        if (highlightedRow) {
            var rightTbody = document.getElementById('userPapersTable').getElementsByTagName('tbody')[0];
            var newRow = highlightedRow.cloneNode(true);
            newRow.onclick = function() { highlightRow(this, 'userPapersTable'); };
            rightTbody.appendChild(newRow);
            leftTbody.removeChild(highlightedRow);

            var rightHighlighted = rightTbody.querySelector('tr.highlight');
            if (rightHighlighted) rightHighlighted.classList.remove('highlight');
            newRow.classList.add('highlight');

            var leftFirstRow = leftTbody.querySelector('tr');
            if (leftFirstRow) leftFirstRow.classList.add('highlight');
        }
    }

    function transferLeft() {
        var rightTable = document.getElementById('userPapersTable');
        var rightTbody = rightTable.getElementsByTagName('tbody')[0];
        var highlightedRow = rightTbody.querySelector('tr.highlight');

        if (highlightedRow) {
            var leftTbody = document.getElementById('allPapersTable').getElementsByTagName('tbody')[0];
            var newRow = highlightedRow.cloneNode(true);
            newRow.onclick = function() { highlightRow(this, 'allPapersTable'); };
            leftTbody.appendChild(newRow);
            rightTbody.removeChild(highlightedRow);

            var leftHighlighted = leftTbody.querySelector('tr.highlight');
            if (leftHighlighted) leftHighlighted.classList.remove('highlight');
            newRow.classList.add('highlight');

            var rightFirstRow = rightTbody.querySelector('tr');
            if (rightFirstRow) rightFirstRow.classList.add('highlight');
        }
    }

    function submitUserPapers() {
        const ids = Array.from(
            document.querySelectorAll('#userPapersTable tbody tr td:first-child')
        ).map(td => td.textContent.trim());

        document.getElementById('examPaperIdsInput').value = ids.join(',');
        document.getElementById('hiddenForm').submit();
    }

    // 初始化行点击事件
    document.addEventListener('DOMContentLoaded', function() {
        var leftFirstRow = document.querySelector('#allPapersTable tbody tr');
        var rightFirstRow = document.querySelector('#userPapersTable tbody tr');

        if (leftFirstRow) highlightRow(leftFirstRow, 'allPapersTable');
        if (rightFirstRow) highlightRow(rightFirstRow, 'userPapersTable');

        var leftRows = document.querySelectorAll('#allPapersTable tbody tr');
        leftRows.forEach(function(row) {
            row.onclick = function() { highlightRow(this, 'allPapersTable'); };
        });

        var rightRows = document.querySelectorAll('#userPapersTable tbody tr');
        rightRows.forEach(function(row) {
            row.onclick = function() { highlightRow(this, 'userPapersTable'); };
        });
    });
</script>
</body>
</html>
上面是试卷管理主页面
请用spring boot+MVC+MyBatis+Vue重构上述代码功能，保持实体类不动，service尽量不要动，页面展示不要动，请给出完整代码
